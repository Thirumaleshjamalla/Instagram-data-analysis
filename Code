import zipfile
import os
import pandas as pd
zip_path = r"C:\Users\saipr\Downloads\archive (2).zip"
extract_dir = r"C:\Users\saipr\Downloads\instagram_extract"

os.makedirs(extract_dir, exist_ok=True)

with zipfile.ZipFile(zip_path, "r") as z:
    z.extractall(extract_dir)

print("ZIP extracted successfully!")

files = os.listdir(extract_dir)
print("\nExtracted files:", files)

csv_files = [f for f in files if f.endswith(".csv")]
json_files = [f for f in files if f.endswith(".json")]

print("CSV Files:", csv_files)
print("JSON Files:", json_files)

df = None

if csv_files:
    df = pd.read_csv(os.path.join(extract_dir, csv_files[0]))
    print("\nLoaded CSV file:", csv_files[0])

elif json_files:
    df = pd.read_json(os.path.join(extract_dir, json_files[0]))
    print("\nLoaded JSON file:", json_files[0])

else:
    print("\nNo CSV or JSON found in the zip.")
if df is not None:
    print("\nFirst 5 rows:\n", df.head())
